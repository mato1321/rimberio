import chromadb
# 核心維度定義 ---
DIMENSIONS = [
    "Activity",      # 0: 活動力
    "Affection",     # 1: 親人程度
    "Independence",  # 2: 獨立性
    "Space",         # 3: 空間需求
    "Grooming",      # 4: 掉毛程度
    "Noise"          # 5: 吵鬧程度
]
# 寵物模擬資料庫
PET_DB = [
    {
        "id": "1",
        "name": "柴犬",
        "vector": [0.5, 0.6, 0.4, 0.5, 0.4, 0.5],
        "desc": "柴犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "2",
        "name": "黃金獵犬",
        "vector": [0.6, 0.7, 0.5, 0.6, 0.5, 0.6],
        "desc": "黃金獵犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "3",
        "name": "拉布拉多",
        "vector": [0.7, 0.8, 0.6, 0.7, 0.6, 0.7],
        "desc": "拉布拉多，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "4",
        "name": "邊境牧羊犬",
        "vector": [0.8, 0.5, 0.3, 0.8, 0.3, 0.4],
        "desc": "邊境牧羊犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "5",
        "name": "哈士奇",
        "vector": [0.4, 0.6, 0.4, 0.4, 0.4, 0.5],
        "desc": "哈士奇，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "6",
        "name": "法國鬥牛犬",
        "vector": [0.5, 0.7, 0.5, 0.5, 0.5, 0.6],
        "desc": "法國鬥牛犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "7",
        "name": "吉娃娃",
        "vector": [0.6, 0.8, 0.6, 0.6, 0.6, 0.7],
        "desc": "吉娃娃，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "8",
        "name": "博美犬",
        "vector": [0.7, 0.5, 0.3, 0.7, 0.3, 0.4],
        "desc": "博美犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "9",
        "name": "臘腸犬",
        "vector": [0.8, 0.6, 0.4, 0.8, 0.4, 0.5],
        "desc": "臘腸犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "10",
        "name": "薩摩耶",
        "vector": [0.4, 0.7, 0.5, 0.4, 0.5, 0.6],
        "desc": "薩摩耶，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "11",
        "name": "德國牧羊犬",
        "vector": [0.5, 0.8, 0.6, 0.5, 0.6, 0.7],
        "desc": "德國牧羊犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "12",
        "name": "秋田犬",
        "vector": [0.6, 0.5, 0.3, 0.6, 0.3, 0.4],
        "desc": "秋田犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "13",
        "name": "米克斯",
        "vector": [0.7, 0.6, 0.4, 0.7, 0.4, 0.5],
        "desc": "米克斯，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "14",
        "name": "柯基犬",
        "vector": [0.8, 0.7, 0.5, 0.8, 0.5, 0.6],
        "desc": "柯基犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "15",
        "name": "比熊犬",
        "vector": [0.4, 0.8, 0.6, 0.4, 0.6, 0.7],
        "desc": "比熊犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "16",
        "name": "貴賓犬",
        "vector": [0.5, 0.5, 0.3, 0.5, 0.3, 0.4],
        "desc": "貴賓犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "17",
        "name": "西施犬",
        "vector": [0.6, 0.6, 0.4, 0.6, 0.4, 0.5],
        "desc": "西施犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "18",
        "name": "巴哥犬",
        "vector": [0.7, 0.7, 0.5, 0.7, 0.5, 0.6],
        "desc": "巴哥犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "19",
        "name": "杜賓犬",
        "vector": [0.8, 0.8, 0.6, 0.8, 0.6, 0.7],
        "desc": "杜賓犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "20",
        "name": "拳師犬",
        "vector": [0.4, 0.5, 0.3, 0.4, 0.3, 0.4],
        "desc": "拳師犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "21",
        "name": "馬爾濟斯",
        "vector": [0.5, 0.6, 0.4, 0.5, 0.4, 0.5],
        "desc": "馬爾濟斯，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "22",
        "name": "約克夏",
        "vector": [0.6, 0.7, 0.5, 0.6, 0.5, 0.6],
        "desc": "約克夏，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "23",
        "name": "阿拉斯加雪橇犬",
        "vector": [0.7, 0.8, 0.6, 0.7, 0.6, 0.7],
        "desc": "阿拉斯加雪橇犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "24",
        "name": "羅威納",
        "vector": [0.8, 0.5, 0.3, 0.8, 0.3, 0.4],
        "desc": "羅威納，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "25",
        "name": "鬆獅犬",
        "vector": [0.4, 0.6, 0.4, 0.4, 0.4, 0.5],
        "desc": "鬆獅犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "26",
        "name": "英國鬥牛犬",
        "vector": [0.5, 0.7, 0.5, 0.5, 0.5, 0.6],
        "desc": "英國鬥牛犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "27",
        "name": "波士頓㹴",
        "vector": [0.6, 0.8, 0.6, 0.6, 0.6, 0.7],
        "desc": "波士頓㹴，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "28",
        "name": "比特犬",
        "vector": [0.7, 0.5, 0.3, 0.7, 0.3, 0.4],
        "desc": "比特犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "29",
        "name": "西高地白㹴",
        "vector": [0.8, 0.6, 0.4, 0.8, 0.4, 0.5],
        "desc": "西高地白㹴，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "30",
        "name": "喜樂蒂牧羊犬",
        "vector": [0.4, 0.7, 0.5, 0.4, 0.5, 0.6],
        "desc": "喜樂蒂牧羊犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "31",
        "name": "可卡犬",
        "vector": [0.5, 0.8, 0.6, 0.5, 0.6, 0.7],
        "desc": "可卡犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "32",
        "name": "比利時牧羊犬",
        "vector": [0.6, 0.5, 0.3, 0.6, 0.3, 0.4],
        "desc": "比利時牧羊犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "33",
        "name": "大丹犬",
        "vector": [0.7, 0.6, 0.4, 0.7, 0.4, 0.5],
        "desc": "大丹犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "34",
        "name": "聖伯納犬",
        "vector": [0.8, 0.7, 0.5, 0.8, 0.5, 0.6],
        "desc": "聖伯納犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "35",
        "name": "伯恩山犬",
        "vector": [0.4, 0.8, 0.6, 0.4, 0.6, 0.7],
        "desc": "伯恩山犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "36",
        "name": "阿富汗獵犬",
        "vector": [0.5, 0.5, 0.3, 0.5, 0.3, 0.4],
        "desc": "阿富汗獵犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "37",
        "name": "獵狐㹴",
        "vector": [0.6, 0.6, 0.4, 0.6, 0.4, 0.5],
        "desc": "獵狐㹴，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "38",
        "name": "比格犬",
        "vector": [0.7, 0.7, 0.5, 0.7, 0.5, 0.6],
        "desc": "比格犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "39",
        "name": "巴吉度獵犬",
        "vector": [0.8, 0.8, 0.6, 0.8, 0.6, 0.7],
        "desc": "巴吉度獵犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "40",
        "name": "牛頭㹴",
        "vector": [0.4, 0.5, 0.3, 0.4, 0.3, 0.4],
        "desc": "牛頭㹴，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "41",
        "name": "中國冠毛犬",
        "vector": [0.5, 0.6, 0.4, 0.5, 0.4, 0.5],
        "desc": "中國冠毛犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "42",
        "name": "愛爾蘭雪達犬",
        "vector": [0.6, 0.7, 0.5, 0.6, 0.5, 0.6],
        "desc": "愛爾蘭雪達犬，具備該犬種典型性格特徵，飼養前需評估活動量、空間與照顧時間是否合適。"
    },
    {
        "id": "43",
        "name": "英國短毛貓",
        "vector": [0.3, 0.5, 0.9, 0.3, 0.5, 0.2],
        "desc": "圓乎乎的泰迪熊，性格獨立且安靜，不太黏人，適合忙碌的上班族。"
    },
    {
        "id": "44",
        "name": "暹羅貓",
        "vector": [0.9, 0.9, 0.2, 0.5, 0.2, 1.0],
        "desc": "貓界像皮糖與話癆，極度黏人且愛講話，需要大量互動與陪伴，怕孤單。"
    },
    {
        "id": "45",
        "name": "波斯貓",
        "vector": [0.1, 0.7, 0.6, 0.2, 1.0, 0.1],
        "desc": "優雅的貴族，活動力低，喜歡安靜，長毛需要每天梳理避免打結。"
    },
    {
        "id": "46",
        "name": "布偶貓",
        "vector": [0.3, 1.0, 0.1, 0.4, 0.8, 0.2],
        "desc": "像布娃娃般柔軟，脾氣極好且黏人，缺乏安全感，適合有小孩的家庭。"
    },
    {
        "id": "47",
        "name": "緬因貓",
        "vector": [0.7, 0.8, 0.5, 0.9, 0.9, 0.4],
        "desc": "溫柔的巨人，像狗一樣親人且聰明，體型巨大，需要較大的垂直活動空間。"
    },
    {
        "id": "48",
        "name": "孟加拉豹貓",
        "vector": [1.0, 0.5, 0.7, 1.0, 0.2, 0.8],
        "desc": "擁有狂野斑紋，精力充沛像裝了電池，需要大量運動與豐富的玩具，喜歡水。"
    },
    {
        "id": "49",
        "name": "斯芬克斯",
        "vector": [0.8, 0.9, 0.1, 0.3, 0.9, 0.5],
        "desc": "像外星人的小精靈，無毛但皮膚需要定期擦拭護理，極度親人且怕冷。"
    },
    {
        "id": "50",
        "name": "俄羅斯藍貓",
        "vector": [0.5, 0.6, 0.8, 0.3, 0.3, 0.1],
        "desc": "害羞的紳士，對陌生人有戒心但對主人忠誠，喜歡安靜規律的生活。"
    },
    {
        "id": "51",
        "name": "美國短毛貓",
        "vector": [0.6, 0.7, 0.6, 0.5, 0.3, 0.3],
        "desc": "身體健壯且適應力強，性格隨和好相處，是新手入門的模範貓種。"
    },
    {
        "id": "52",
        "name": "蘇格蘭折耳貓",
        "vector": [0.3, 0.8, 0.4, 0.3, 0.5, 0.2],
        "desc": "折耳像貓頭鷹般可愛，性格甜美安靜，但需特別注意遺傳骨骼疾病的照護。"
    },
    {
        "id": "53",
        "name": "阿比西尼亞貓",
        "vector": [0.9, 0.7, 0.3, 0.7, 0.2, 0.3],
        "desc": "貓界攀岩高手，非常聰明好動，喜歡站在高處觀察一切，不甘寂寞。"
    },
    {
        "id": "54",
        "name": "異國短毛貓",
        "vector": [0.2, 0.7, 0.5, 0.2, 0.4, 0.1],
        "desc": "加菲貓的原型，擁有波斯貓的懶洋洋性格但更好整理，呆萌可愛。"
    },
    {
        "id": "55",
        "name": "挪威森林貓",
        "vector": [0.7, 0.7, 0.6, 0.8, 0.8, 0.3],
        "desc": "來自北歐的森林精靈，擅長攀爬，毛髮厚實防水，性格穩重獨立。"
    },
    {
        "id": "56",
        "name": "德文捲毛貓",
        "vector": [0.9, 0.9, 0.2, 0.4, 0.2, 0.5],
        "desc": "捲毛小精靈，性格像狗一樣活潑黏人，喜歡停在主人肩膀上，掉毛極少。"
    },
    {
        "id": "57",
        "name": "伯曼貓",
        "vector": [0.4, 0.9, 0.3, 0.4, 0.7, 0.2],
        "desc": "帶著白手套的優雅貓咪，性格溫和友善，介於波斯貓與暹羅貓之間。"
    },
    {
        "id": "58",
        "name": "東方短毛貓",
        "vector": [0.9, 0.9, 0.2, 0.5, 0.2, 0.9],
        "desc": "像精靈般的貓，性格與暹羅貓相似，極度聰明、黏人且多話，需要陪伴。"
    },
    {
        "id": "59",
        "name": "康沃爾捲毛貓",
        "vector": [0.9, 0.8, 0.3, 0.4, 0.2, 0.4],
        "desc": "擁有蛋捲般的捲毛，身材修長，性格像狗一樣愛玩，喜歡溫暖的地方。"
    },
    {
        "id": "60",
        "name": "曼赤肯貓",
        "vector": [0.6, 0.7, 0.5, 0.3, 0.4, 0.3],
        "desc": "短腿貓界的柯基，雖然腿短但動作靈活，性格開朗像長不大的孩子。"
    },
    {
        "id": "61",
        "name": "西伯利亞貓",
        "vector": [0.7, 0.8, 0.4, 0.8, 0.8, 0.4],
        "desc": "俄羅斯的國寶，體型強壯，毛髮豐厚，性格像狗一樣忠誠，據說較低過敏性。"
    },
    {
        "id": "62",
        "name": "土耳其安哥拉貓",
        "vector": [0.8, 0.6, 0.5, 0.6, 0.6, 0.4],
        "desc": "游泳健將，姿態優雅，聰明且意志堅定，喜歡玩水和高處。"
    },
    {
        "id": "63",
        "name": "美國捲耳貓",
        "vector": [0.6, 0.8, 0.4, 0.5, 0.4, 0.2],
        "desc": "耳朵向後捲曲，長相獨特，性格像彼得潘一樣永遠保持童心，親人好客。"
    },
    {
        "id": "64",
        "name": "索馬利貓",
        "vector": [0.9, 0.7, 0.3, 0.7, 0.6, 0.3],
        "desc": "長毛版的阿比西尼亞貓，像小狐狸般美麗，精力旺盛，充滿好奇心。"
    },
    {
        "id": "65",
        "name": "孟買貓",
        "vector": [0.7, 0.9, 0.3, 0.4, 0.2, 0.5],
        "desc": "像迷你黑豹，性格卻像狗狗一樣親人，喜歡跟在主人腳邊，不愛獨處。"
    },
    {
        "id": "66",
        "name": "緬甸貓",
        "vector": [0.8, 0.9, 0.2, 0.5, 0.2, 0.6],
        "desc": "披著絲綢的磚塊，身體結實，極度黏人，喜歡成為注意力的中心。"
    },
    {
        "id": "67",
        "name": "新加坡貓",
        "vector": [0.6, 0.8, 0.4, 0.2, 0.2, 0.3],
        "desc": "世界上最小的貓種之一，大眼睛大耳朵，性格溫和細膩，喜歡鑽進被窩。"
    },
    {
        "id": "68",
        "name": "埃及貓",
        "vector": [0.9, 0.6, 0.6, 0.6, 0.3, 0.4],
        "desc": "唯一天然斑點家貓，跑得極快，性格忠誠但對陌生人害羞，佔有慾強。"
    },
    {
        "id": "69",
        "name": "日本短尾貓",
        "vector": [0.7, 0.7, 0.5, 0.4, 0.3, 0.4],
        "desc": "招財貓的原型，尾巴像兔子，性格聰明活潑，適應力強，喜歡說話。"
    },
    {
        "id": "70",
        "name": "拉珀姆貓",
        "vector": [0.7, 0.8, 0.4, 0.5, 0.5, 0.3],
        "desc": "毛髮像燙過一樣捲曲，性格非常有愛，喜歡用爪子輕拍主人求關注。"
    },
    {
        "id": "71",
        "name": "沙特爾貓",
        "vector": [0.4, 0.6, 0.7, 0.4, 0.4, 0.2],
        "desc": "法國藍貓，微笑的貓咪，性格沈穩安靜，也是捕鼠高手，適合安靜家庭。"
    },
    {
        "id": "72",
        "name": "柯尼斯捲毛貓",
        "vector": [0.9, 0.8, 0.3, 0.4, 0.2, 0.4],
        "desc": "擁有蛋捲般的捲毛，身材修長，性格像狗一樣愛玩，喜歡溫暖的地方。"
    },
    {
        "id": "73",
        "name": "襤褸貓",
        "vector": [0.2, 0.9, 0.2, 0.4, 0.8, 0.2],
        "desc": "布偶貓的近親，像大泰迪熊一樣，性格極度甜美，完全信任人類，適合新手。"
    },
    {
        "id": "74",
        "name": "東奇尼貓",
        "vector": [0.8, 0.9, 0.3, 0.5, 0.3, 0.7],
        "desc": "暹羅貓與緬甸貓的混血，綜合了兩者的優點，聰明活潑且極度親人。"
    },
    {
        "id": "75",
        "name": "土耳其梵貓",
        "vector": [0.9, 0.6, 0.5, 0.7, 0.6, 0.5],
        "desc": "游泳貓，喜歡玩水，身體修長，性格獨立聰明，精力充沛。"
    },
    {
        "id": "76",
        "name": "塞爾凱克捲毛貓",
        "vector": [0.4, 0.7, 0.5, 0.4, 0.6, 0.3],
        "desc": "披著羊皮的貓，毛髮濃密捲曲，性格隨和沈穩，像英國短毛貓般友善。"
    },
    {
        "id": "77",
        "name": "雪鞋貓",
        "vector": [0.7, 0.8, 0.4, 0.5, 0.3, 0.6],
        "desc": "穿著白襪子的暹羅貓近親，性格活潑親人，喜歡水，需要陪伴。"
    },
    {
        "id": "78",
        "name": "歐西貓",
        "vector": [0.8, 0.7, 0.5, 0.6, 0.3, 0.5],
        "desc": "像野生豹貓但性格完全是家貓，聰明好訓練，可以像狗一樣遛。"
    },
    {
        "id": "79",
        "name": "柯拉特貓",
        "vector": [0.5, 0.8, 0.4, 0.4, 0.2, 0.3],
        "desc": "泰國吉祥貓，銀藍色毛髮，感官敏銳，對主人忠誠，不喜歡突如其來的噪音。"
    },
    {
        "id": "80",
        "name": "美國剛毛貓",
        "vector": [0.6, 0.6, 0.6, 0.4, 0.3, 0.3],
        "desc": "毛髮粗硬像鋼絲刷，性格溫和適應力強，與美國短毛貓相似但較罕見。"
    },
    {
        "id": "81",
        "name": "馬恩島貓",
        "vector": [0.6, 0.7, 0.5, 0.4, 0.4, 0.3],
        "desc": "無尾貓，後腿長跳躍力強，像兔子一樣，性格圓融忠誠，看家護院好手。"
    },
    {
        "id": "82",
        "name": "巴厘貓",
        "vector": [0.8, 0.9, 0.3, 0.5, 0.6, 0.8],
        "desc": "長毛版的暹羅貓，優雅如舞者，性格與暹羅貓一樣外向黏人，但聲音較柔和。"
    },
    {
        "id": "83",
        "name": "喜馬拉雅貓",
        "vector": [0.2, 0.8, 0.5, 0.3, 0.9, 0.2],
        "desc": "波斯貓與暹羅貓的混血，擁有波斯的長毛與暹羅的重點色，甜美溫柔。"
    }
]
# 問卷題目設計
QUESTIONS = [
    {
        "id": "q1",
        "dimension_index": 0,
        "weight": 0.2,
        "text": "【Q1/30 活動力】\n你每天能陪狗進行戶外活動多久？",
        "options": [
            {
                "label": "30分鐘以內",
                "value": 0.1,
                "text": "較低程度"
            },
            {
                "label": "30-90分鐘",
                "value": 0.5,
                "text": "中等程度"
            },
            {
                "label": "超過90分鐘",
                "value": 0.9,
                "text": "較高程度"
            }
        ]
    },
    {
        "id": "q2",
        "dimension_index": 0,
        "weight": 0.2,
        "text": "【Q2/30 活動力】\n週末假日你通常偏好哪種休閒方式？",
        "options": [
            {
                "label": "在家休息",
                "value": 0.1,
                "text": "靜態休息"
            },
            {
                "label": "附近公園散步",
                "value": 0.5,
                "text": "輕鬆活動"
            },
            {
                "label": "長途登山或跑步",
                "value": 0.9,
                "text": "高強度運動"
            }
        ]
    },
    {
        "id": "q3",
        "dimension_index": 0,
        "weight": 0.2,
        "text": "【Q3/30 活動力】\n你能接受狗狗在家中也保持高度活躍（如跑酷）嗎？",
        "options": [
            {
                "label": "希望牠安靜點",
                "value": 0.1,
                "text": "不接受"
            },
            {
                "label": "偶爾可以",
                "value": 0.5,
                "text": "尚可接受"
            },
            {
                "label": "完全沒問題",
                "value": 0.9,
                "text": "非常接受"
            }
        ]
    },
    {
        "id": "q4",
        "dimension_index": 0,
        "weight": 0.2,
        "text": "【Q4/30 活動力】\n若狗狗精力過剩需要每天玩拋接球 30 分鐘，你的意願是？",
        "options": [
            {
                "label": "太累了",
                "value": 0.1,
                "text": "意願低"
            },
            {
                "label": "盡力配合",
                "value": 0.5,
                "text": "意願普通"
            },
            {
                "label": "我很樂意",
                "value": 0.9,
                "text": "意願高"
            }
        ]
    },
    {
        "id": "q5",
        "dimension_index": 0,
        "weight": 0.2,
        "text": "【Q5/30 活動力】\n你希望狗狗在戶外是跟隨腳步走，還是盡情奔跑探索？",
        "options": [
            {
                "label": "慢慢走",
                "value": 0.1,
                "text": "跟隨腳步"
            },
            {
                "label": "適度探索",
                "value": 0.5,
                "text": "兩者皆有"
            },
            {
                "label": "瘋狂奔跑",
                "value": 0.9,
                "text": "盡情奔跑"
            }
        ]
    },
    {
        "id": "q6",
        "dimension_index": 1,
        "weight": 0.2,
        "text": "【Q6/30 親人程度】\n你希望狗狗多常主動與你互動？",
        "options": [
            {
                "label": "偶爾就好",
                "value": 0.1,
                "text": "較低程度"
            },
            {
                "label": "每天幾次",
                "value": 0.5,
                "text": "中等程度"
            },
            {
                "label": "隨時隨地",
                "value": 0.9,
                "text": "較高程度"
            }
        ]
    },
    {
        "id": "q7",
        "dimension_index": 1,
        "weight": 0.2,
        "text": "【Q7/30 親人程度】\n當你在家工作或休息時，你希望狗狗在哪裡？",
        "options": [
            {
                "label": "在另一個房間",
                "value": 0.1,
                "text": "保持距離"
            },
            {
                "label": "在腳邊趴著",
                "value": 0.5,
                "text": "適度陪伴"
            },
            {
                "label": "要抱抱蹭人",
                "value": 0.9,
                "text": "緊密接觸"
            }
        ]
    },
    {
        "id": "q8",
        "dimension_index": 1,
        "weight": 0.2,
        "text": "【Q8/30 親人程度】\n你能接受狗狗像「跟屁蟲」一樣，連去廁所都要跟著嗎？",
        "options": [
            {
                "label": "覺得煩",
                "value": 0.1,
                "text": "無法接受"
            },
            {
                "label": "無所謂",
                "value": 0.5,
                "text": "可以接受"
            },
            {
                "label": "覺得很可愛",
                "value": 0.9,
                "text": "非常喜歡"
            }
        ]
    },
    {
        "id": "q9",
        "dimension_index": 1,
        "weight": 0.2,
        "text": "【Q9/30 親人程度】\n對於狗狗主動討摸或舔人的行為，你的接受度是？",
        "options": [
            {
                "label": "不喜歡口水",
                "value": 0.1,
                "text": "低接受度"
            },
            {
                "label": "看心情",
                "value": 0.5,
                "text": "中接受度"
            },
            {
                "label": "來者不拒",
                "value": 0.9,
                "text": "高接受度"
            }
        ]
    },
    {
        "id": "q10",
        "dimension_index": 1,
        "weight": 0.2,
        "text": "【Q10/30 親人程度】\n你希望這隻狗是對陌生人也熱情，還是只對家人親近？",
        "options": [
            {
                "label": "只對家人好",
                "value": 0.1,
                "text": "忠誠護主"
            },
            {
                "label": "看情況",
                "value": 0.5,
                "text": "中庸之道"
            },
            {
                "label": "人人好",
                "value": 0.9,
                "text": "熱情公關"
            }
        ]
    },
    {
        "id": "q11",
        "dimension_index": 2,
        "weight": 0.2,
        "text": "【Q11/30 獨立性】\n你能接受狗狗長時間自行待在家中嗎？",
        "options": [
            {
                "label": "希望牠有人陪",
                "value": 0.1,
                "text": "較低程度"
            },
            {
                "label": "半天可以",
                "value": 0.5,
                "text": "中等程度"
            },
            {
                "label": "一整天沒問題",
                "value": 0.9,
                "text": "較高程度"
            }
        ]
    },
    {
        "id": "q12",
        "dimension_index": 2,
        "weight": 0.2,
        "text": "【Q12/30 獨立性】\n你每週平均有多少天需要讓狗狗獨自在家超過 8 小時？",
        "options": [
            {
                "label": "幾乎沒有",
                "value": 0.1,
                "text": "很少獨處"
            },
            {
                "label": "2-3天",
                "value": 0.5,
                "text": "偶爾獨處"
            },
            {
                "label": "5天以上",
                "value": 0.9,
                "text": "經常獨處"
            }
        ]
    },
    {
        "id": "q13",
        "dimension_index": 2,
        "weight": 0.2,
        "text": "【Q13/30 獨立性】\n當你出門時，你希望狗狗的反應是？",
        "options": [
            {
                "label": "焦慮吠叫",
                "value": 0.1,
                "text": "依賴心強"
            },
            {
                "label": "觀察一下去睡覺",
                "value": 0.5,
                "text": "適度獨立"
            },
            {
                "label": "完全不在意",
                "value": 0.9,
                "text": "非常獨立"
            }
        ]
    },
    {
        "id": "q14",
        "dimension_index": 2,
        "weight": 0.2,
        "text": "【Q14/30 獨立性】\n你的工作性質是否允許你隨時回家查看或帶狗上班？",
        "options": [
            {
                "label": "完全允許",
                "value": 0.1,
                "text": "陪伴時間多"
            },
            {
                "label": "偶爾可以",
                "value": 0.5,
                "text": "彈性普通"
            },
            {
                "label": "完全不行",
                "value": 0.9,
                "text": "陪伴時間少"
            }
        ]
    },
    {
        "id": "q15",
        "dimension_index": 2,
        "weight": 0.2,
        "text": "【Q15/30 獨立性】\n你能接受狗狗個性較為自我，不一定隨叫隨到嗎？",
        "options": [
            {
                "label": "希望隨叫隨到",
                "value": 0.1,
                "text": "低接受度"
            },
            {
                "label": "偶爾自我可以",
                "value": 0.5,
                "text": "中接受度"
            },
            {
                "label": "很有個性也好",
                "value": 0.9,
                "text": "高接受度"
            }
        ]
    },
    {
        "id": "q16",
        "dimension_index": 3,
        "weight": 0.2,
        "text": "【Q16/30 空間需求】\n你的居住空間是否適合中大型犬活動？",
        "options": [
            {
                "label": "空間狹小",
                "value": 0.1,
                "text": "較低程度"
            },
            {
                "label": "空間適中",
                "value": 0.5,
                "text": "中等程度"
            },
            {
                "label": "空間寬敞",
                "value": 0.9,
                "text": "較高程度"
            }
        ]
    },
    {
        "id": "q17",
        "dimension_index": 3,
        "weight": 0.2,
        "text": "【Q17/30 空間需求】\n你的居住環境是否有電梯？",
        "options": [
            {
                "label": "無電梯公寓高樓",
                "value": 0.1,
                "text": "無電梯"
            },
            {
                "label": "低樓層或透天",
                "value": 0.5,
                "text": "低樓層"
            },
            {
                "label": "有電梯",
                "value": 0.9,
                "text": "有電梯"
            }
        ]
    },
    {
        "id": "q18",
        "dimension_index": 3,
        "weight": 0.2,
        "text": "【Q18/30 空間需求】\n家中是否有專屬的庭院或陽台供狗狗活動？",
        "options": [
            {
                "label": "都沒有",
                "value": 0.1,
                "text": "無戶外空間"
            },
            {
                "label": "小陽台",
                "value": 0.5,
                "text": "小空間"
            },
            {
                "label": "大庭院",
                "value": 0.9,
                "text": "大空間"
            }
        ]
    },
    {
        "id": "q19",
        "dimension_index": 3,
        "weight": 0.2,
        "text": "【Q19/30 空間需求】\n你能接受家中擺放大型狗籠或佔據沙發大部分空間嗎？",
        "options": [
            {
                "label": "沒地方放",
                "value": 0.1,
                "text": "無法接受"
            },
            {
                "label": "喬一下可以",
                "value": 0.5,
                "text": "勉強接受"
            },
            {
                "label": "為了狗狗可以",
                "value": 0.9,
                "text": "完全接受"
            }
        ]
    },
    {
        "id": "q20",
        "dimension_index": 3,
        "weight": 0.2,
        "text": "【Q20/30 空間需求】\n若狗狗尾巴橫掃容易打翻茶几上的物品，你的接受度是？",
        "options": [
            {
                "label": "會很崩潰",
                "value": 0.1,
                "text": "低忍受度"
            },
            {
                "label": "收好東西就好",
                "value": 0.5,
                "text": "中忍受度"
            },
            {
                "label": "習慣就好",
                "value": 0.9,
                "text": "高忍受度"
            }
        ]
    },
    {
        "id": "q21",
        "dimension_index": 4,
        "weight": 0.2,
        "text": "【Q21/30 掉毛程度】\n你能接受定期為狗狗進行毛髮整理嗎？",
        "options": [
            {
                "label": "沒時間/不想",
                "value": 0.1,
                "text": "較低程度"
            },
            {
                "label": "偶爾梳理",
                "value": 0.5,
                "text": "中等程度"
            },
            {
                "label": "每天梳理",
                "value": 0.9,
                "text": "較高程度"
            }
        ]
    },
    {
        "id": "q22",
        "dimension_index": 4,
        "weight": 0.2,
        "text": "【Q22/30 掉毛程度】\n對於家中地板或衣服上出現狗毛的忍受程度？",
        "options": [
            {
                "label": "完全不能接受",
                "value": 0.1,
                "text": "潔癖"
            },
            {
                "label": "有一點沒關係",
                "value": 0.5,
                "text": "普通"
            },
            {
                "label": "視為養狗日常",
                "value": 0.9,
                "text": "無所謂"
            }
        ]
    },
    {
        "id": "q23",
        "dimension_index": 4,
        "weight": 0.2,
        "text": "【Q23/30 掉毛程度】\n你願意每個月花多少預算或時間在狗狗的美容洗澡上？",
        "options": [
            {
                "label": "越少越好",
                "value": 0.1,
                "text": "低預算"
            },
            {
                "label": "適度花費",
                "value": 0.5,
                "text": "中預算"
            },
            {
                "label": "不惜成本",
                "value": 0.9,
                "text": "高預算"
            }
        ]
    },
    {
        "id": "q24",
        "dimension_index": 4,
        "weight": 0.2,
        "text": "【Q24/30 掉毛程度】\n你能接受狗狗有口水較多或嘴邊毛易髒的特質嗎？",
        "options": [
            {
                "label": "覺得噁心",
                "value": 0.1,
                "text": "無法接受"
            },
            {
                "label": "擦擦就好",
                "value": 0.5,
                "text": "尚可接受"
            },
            {
                "label": "完全不介意",
                "value": 0.9,
                "text": "非常接受"
            }
        ]
    },
    {
        "id": "q25",
        "dimension_index": 4,
        "weight": 0.2,
        "text": "【Q25/30 掉毛程度】\n你是否對狗毛或皮屑有過敏體質？",
        "options": [
            {
                "label": "嚴重過敏",
                "value": 0.1,
                "text": "非常敏感"
            },
            {
                "label": "輕微過敏",
                "value": 0.5,
                "text": "輕微敏感"
            },
            {
                "label": "完全不過敏",
                "value": 0.9,
                "text": "不敏感"
            }
        ]
    },
    {
        "id": "q26",
        "dimension_index": 5,
        "weight": 0.2,
        "text": "【Q26/30 吵鬧程度】\n你能接受狗吠或嚎叫對生活造成影響嗎？",
        "options": [
            {
                "label": "完全不能",
                "value": 0.1,
                "text": "較低程度"
            },
            {
                "label": "偶爾可以",
                "value": 0.5,
                "text": "中等程度"
            },
            {
                "label": "習慣了",
                "value": 0.9,
                "text": "較高程度"
            }
        ]
    },
    {
        "id": "q27",
        "dimension_index": 5,
        "weight": 0.2,
        "text": "【Q27/30 吵鬧程度】\n你的居住環境隔音效果如何？",
        "options": [
            {
                "label": "隔音差/怕投訴",
                "value": 0.1,
                "text": "隔音差"
            },
            {
                "label": "普通公寓",
                "value": 0.5,
                "text": "隔音普通"
            },
            {
                "label": "獨棟/不怕吵",
                "value": 0.9,
                "text": "隔音好"
            }
        ]
    },
    {
        "id": "q28",
        "dimension_index": 5,
        "weight": 0.2,
        "text": "【Q28/30 吵鬧程度】\n當有快遞或陌生人經過門口時，你希望狗狗的反應是？",
        "options": [
            {
                "label": "安靜忽視",
                "value": 0.1,
                "text": "安靜"
            },
            {
                "label": "低吼警戒",
                "value": 0.5,
                "text": "警戒"
            },
            {
                "label": "大聲吠叫",
                "value": 0.9,
                "text": "吠叫"
            }
        ]
    },
    {
        "id": "q29",
        "dimension_index": 5,
        "weight": 0.2,
        "text": "【Q29/30 吵鬧程度】\n你能忍受狗狗在興奮或玩耍時發出明顯的聲音嗎？",
        "options": [
            {
                "label": "希望安靜玩",
                "value": 0.1,
                "text": "低忍受"
            },
            {
                "label": "適度叫聲",
                "value": 0.5,
                "text": "中忍受"
            },
            {
                "label": "熱鬧點好",
                "value": 0.9,
                "text": "高忍受"
            }
        ]
    },
    {
        "id": "q30",
        "dimension_index": 5,
        "weight": 0.2,
        "text": "【Q30/30 吵鬧程度】\n對於需要花時間訓練狗狗「安靜」這件事，你的耐心程度？",
        "options": [
            {
                "label": "沒耐心",
                "value": 0.1,
                "text": "低耐心"
            },
            {
                "label": "願意嘗試",
                "value": 0.5,
                "text": "中耐心"
            },
            {
                "label": "非常有耐心",
                "value": 0.9,
                "text": "高耐心"
            }
        ]
    }
]

# ChromaDB 初始化與查詢功能
client = chromadb.Client()
collection_name = "rimberio_pets_v1"
try:
    collection = client.get_collection(collection_name)
except:
    collection = client.create_collection(collection_name)
    ids = [p['id'] for p in PET_DB]
    embeddings = [p['vector'] for p in PET_DB]
    metadatas = [{"name": p['name'], "desc": p['desc']} for p in PET_DB]
    collection.add(ids=ids, embeddings=embeddings, metadatas=metadatas)
    print("ChromaDB 資料庫初始化完成，資料已寫入。")

def get_recommendations(user_vector, n_results=3):
    results = collection.query(
        query_embeddings=[user_vector],
        n_results=n_results
    )
    recommendations = []
    for i in range(len(results['ids'][0])):
        recommendations.append({
            "name": results['metadatas'][0][i]['name'],
            "desc": results['metadatas'][0][i]['desc'],
            "score": results['distances'][0][i]
        })
    return recommendations


def validate_questions_weights():
    """驗證所有 QUESTIONS 的權重配置"""
    dimension_weights = {i: 0.0 for i in range(6)}
    dimension_count = {i: 0 for i in range(6)}
    
    for q in QUESTIONS:
        dim = q['dimension_index']
        weight = q.get('weight', 0.0)
        dimension_weights[dim] += weight
        dimension_count[dim] += 1
    
    print("\n" + "="*50)
    print("📋 權重驗證結果")
    print("="*50)
    
    errors = []
    for dim in range(6):
        total_weight = dimension_weights[dim]
        count = dimension_count[dim]
        status = "✅" if abs(total_weight - 1.0) < 0.01 else "❌"
        
        print(f"{status} 維度 {dim}: {count} 題，權重總和 = {total_weight:.4f}")
        
        if abs(total_weight - 1.0) > 0.01:
            errors.append(f"維度 {dim}:  權重總和 = {total_weight:.4f} (應為 1.0)")
    
    print("="*50)
    
    if errors:
        print("❌ 權重驗證失敗：")
        for error in errors:
            print(f"  - {error}")
        return False
    else:
        print("✅ 所有維度的權重配置正確！")
        return True